在1.1笔记中，可以阅读http消息结构，而http缓存则跟消息结构的字段相关
而与http请求相关的字段主要有下面这些


http缓存主要针如css，js，图片等更新频率不大的静态文件。
### 存在于请求头 / 响应头
+ Cache-Control,字段，主要包含下面信息
>> no-store: 所有内容都不缓存
>> no-cache：缓存，但是浏览器使用缓存前，都会请求服务器判断缓存资源是否是最新，它是个比较高贵的存在，因为它只用不过期的缓存。
>> max-age=x(单位秒) 请求缓存后的X秒不再发起请求，属于http1.1属性，与下方Expires(http1.0属性)类似，但优先级要比Expires高。
>> s-maxage=x(单位秒) 代理服务器请求源站缓存后的X秒不再发起请求，只对CDN缓存有效
>> public 客户端和代理服务器(CDN)都可缓存
>> private 只有客户端可以缓存

### 存在于请求头
+ Last-Modified 资源最新修改时间，由服务器告诉浏览器。
+ if-None-Match 缓存资源标识，由浏览器告诉服务器(其实就是上次服务器给的Etag)，和Etag是一对，它两会进行对比

### 存在于响应头
+ Expires  代表资源过期时间，由服务器返回提供，GMT格式日期，是http1.0的属性，在与max-age(http1.1)共存的情况下，优先级要低。
+ Last-Modified 资源最新修改时间，由服务器告诉浏览器。
+ Etag 资源标识，由服务器告诉浏览器。

http缓存主要分为两大类： 
> 强缓存 不发起http请求，直接使用本地缓存，比如浏览器地址栏回车，使用浏览器的刷新按钮，在Expires或max-age生效的情况下，触发的都是强缓存。
> 协商缓存 在使用本地缓存前，先与服务器协商，核对缓存文件是否为最新。比如设置了cache-control=no-cache，不管你做任何操作，都会发起请求，这一类就是协商性缓存了。

### 强缓存
强缓存由下面两个字段控制
+ Cache-Control
+ Expires
  
Cache-Control的max-age优先级比Expires高

### 协商缓存
#### 第一对
+ Last-Modified (响应头) 资源最新修改时间，由服务器告诉浏览器。
+ if-Modified-Since （请求头） 资源最新修改时间，由浏览器告诉服务器(其实就是上次服务器给的Last-Modified，请求又还给服务器对比)，和Last-Modified是一对，它两会进行对比
  
请求发送后，服务器会对比两个属性是否相等，如果相等，返回  304 状态吗

> 存在的问题
浏览器端可以随意修改Expires，Expires不稳定，Last-Modified只能精确到秒，假设文件是在1s内发生变动，Last-Modified无法感知到变化，这种情况下浏览器永远拿不到最新的文件(假想极端情况)。
让服务器与浏览器在过期时间Expires+Last-Modified的基础上，再增加一个文件内容唯一对比标记——Etag与If-None-Match。哦对了，我们说Expires不稳定，这里我们再加入一个max-age来加以代替
#### 第二对
+ Etag (响应头) 资源标识，由服务器告诉浏览器。
+ if-None-Match (请求头) 缓存资源标识，由浏览器告诉服务器(其实就是上次服务器给的Etag)，和Etag是一对，它两会进行对比。

服务器Etag与If-None-Match相同，返回了状态码304

#### http缓存方案
1. md5/hash缓存
   
通过不缓存html，为静态文件添加MD5或者hash标识，解决浏览器无法跳过缓存过期时间主动感知文件变化的问题。

为什么这么做？实现原理是什么？

我们前面说的http缓存方案，服务器与浏览器的文件修改时间对比，文件内容标识对比，前提基础都是建立在两者文件路径完全相同的情况下。

2. CDN缓存

###### 什么是CDN?
了解CDN缓存，先得知道什么是CDN，CDN是构建在网络之上的内容分发网络，依靠部署在各地的边缘服务器，通过中心平台的负载均衡、内容分发、调度等功能模块，使用户就近获取所需内容，降低网络拥塞，提高用户访问响应速度和命中率。CDN的关键技术主要有内容存储和分发技术(较为官方的说明)。

之前看到一个不错的例子，这里直接拿过来举例说说CDN。

假设多年前我们所在的城市只有一个火车站，每次春运，整个城市的人都得去这个火车站买票，人流量以及购票的需求可想而知有多大，为了缓解这个问题，城市的不同区，都出现了火车票代售点，这样每个区的人都可以就近买票了，火车站总站的压力就这样大大减轻了。

我们可以把每个区的售票点称之为CDN节点，也就是前面所说的代理服务器。简而言之，我们可以把CDN理解成浏览器与服务器之间的临时站点，它会替服务器处理一部分的浏览器请求，从而整理减轻总服务器的压力。

我们可以把CDN的价值归纳为：

1.CDN通过分流的形式，大大减轻源站的访问压力。

2.就像住的区比较偏远，每次买票要去城市中心，而这个区后来有了分站，火车票就可以就近购买一样。CDN也解决了跨地区访问问题，根本上为访问提供了加速。

###### 什么是CDN缓存？
CDN边缘节点缓存数据，当浏览器请求，CDN将代替源站判断并处理此处请求。

[http缓存](https://www.cnblogs.com/echolun/p/9419517.html)