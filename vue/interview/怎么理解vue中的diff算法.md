> 必要性

一个组件对应一个 watcher, 具体看代码 lifecyle.js - mountComponent()
为了在更新的过程中准确的知道是谁发生了变化, diff 是很必要的

> 执行方式

patchNode 是 diff 发生的地方, 整体策略： 深度优先，同层比较

> 高效性

patch.js - updateChildren() 函数， 双指针比较法，相同则服用，剩余的批量新增/删除

#### 总结

diff 算法是虚拟 dom 技术的必然产物： 通过新旧虚拟 DOM 作对比（即 diff）， 将变化的地方更新在真实 DOM 上， 另外，也需要 diff 高效的执行对比过程，从而减低时间复杂度为 O(n)

vue2.x 中为了减低 Watcher 粒度，每个组件只有一个 Watcher 与之对应，只有引入 diff 才能精确找到发生变化地方

vue 中 diff 执行的时刻是组件实例执行其更新函数时，它会对比上一次渲染结果 oldVnode 和新的渲染结果 newVnode, 此过程称为 patch

diff 过程整体遵循深度优先、同层比较的策； 两个节点之间比较会根据他们是否拥有子节点或者文本节点做不同操作； 比较两组子节点是算法的重点， 首先假设头尾节点可能相同做 4 次比对尝试，如果没有找到相同节点才按照通用方式遍历查找，查找结束再按情况处理剩下的节点；借助 key 通常可以非常精确找到相同节点，因此整个 patch 过程非常高效。
